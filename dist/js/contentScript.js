(()=>{"use strict";var e=[{pro:0,color:"#FFE652"},{pro:1,color:"#FCD21C"}];const o=function(){function o(){this.canvas=document.getElementById("yylive_bear")}return o.prototype.init=function(){this.canvasRender()},o.prototype.dbclick=function(e){var o=this;this.canvas.addEventListener("dblclick",(function(){var t=document.createElement("audio");t.src="https://web.yystatic.com/project/nearlive-static/mobile/voices/voice_02.mp3",t.autoplay=!0,document.body.appendChild(t),t.addEventListener("ended",(function(){document.body.removeChild(t)})),e();var r=o.canvas.getContext("2d");o.drawChatBox(r,10,100,100,100)}))},o.prototype.canvasRender=function(){var o=this.canvas.getContext("2d"),t=136;o.save(),o.beginPath(),o.moveTo(120,235),o.bezierCurveTo(120,235,80,250,65,310),o.bezierCurveTo(65,310,120,310,120,240),o.fillStyle="#FBC700",o.fill(),o.closePath(),o.beginPath(),o.moveTo(70,290),o.bezierCurveTo(70,290,60,310,80,310),o.bezierCurveTo(80,310,85,290,70,290),o.fillStyle="#86491C",o.fill(),o.closePath(),o.restore(),o.beginPath(),o.moveTo(125,235),o.bezierCurveTo(125,235,165,250,180,310),o.bezierCurveTo(180,310,125,310,125,235),o.fillStyle="#FBC700",o.fill(),o.closePath(),o.beginPath(),o.moveTo(160,295),o.bezierCurveTo(160,295,175,275,180,310),o.bezierCurveTo(180,310,160,310,160,295),o.fillStyle="#86491C",o.fill(),o.closePath(),n(o,121,300,38,50,"#FDD528"),n(o,121,305,20,28,"#FFEFC5"),o.save(),o.beginPath(),o.moveTo(63,251),o.bezierCurveTo(78,276,158,276,173,251),o.bezierCurveTo(173,251,198,216,133,181),o.bezierCurveTo(173,296,203,156,143,188),o.bezierCurveTo(143,188,138,184,133,181),o.bezierCurveTo(131,181,138,164,113,181),o.bezierCurveTo(113,181,108,184,105,186),o.bezierCurveTo(105,186,63,156,68,214),o.bezierCurveTo(68,214,93,196,113,181),o.bezierCurveTo(113,181,43,211,63,251),function(e,o,t,r,n,i){for(var a=e.createLinearGradient(63,251,135,135),c=0;c<i.length;c++)a.addColorStop(i[c].pro,i[c].color);e.fillStyle=a,e.fill()}(o,0,0,0,0,e),o.closePath(),o.restore(),o.save(),o.beginPath(),o.moveTo(95,191),o.bezierCurveTo(95,191,73,176,78,204),i(o,"#8D4F1F"),o.closePath(),o.restore(),o.save(),o.beginPath(),o.moveTo(168,210),o.bezierCurveTo(168,210,173,186,153,194),i(o,"#8D4F1F"),o.closePath(),o.restore(),o.save(),o.beginPath(),o.moveTo(121,216),o.bezierCurveTo(113,191,83,201,78,231),o.bezierCurveTo(78,231,73,258,103,246),o.bezierCurveTo(103,246,123,231,143,246),o.bezierCurveTo(143,246,168,261,165,232),o.bezierCurveTo(165,226,149,181,130,216),o.bezierCurveTo(130,216,127,221,121,216),o.closePath(),i(o,"#8D4F1F"),o.restore(),o.save(),o.beginPath(),n(o,103,224,10,13,"#FFF"),n(o,102,224,8,10,"#8D4F1F"),n(o,103,221,3,4,"#fff"),o.restore();var r=this.canvas;function n(e,o,t,r,n,a){var c=r>n?1/r:1/n;e.beginPath(),e.moveTo(o+r,t);for(var l=0;l<2*Math.PI;l+=c)e.lineTo(o+r*Math.cos(l),t+n*Math.sin(l));e.closePath(),i(e,a)}function i(e,o){e.fillStyle=o,e.fill()}!function(){o.save();var e=225,i=!0,a=14,c=0;function l(){0===a?i=!1:14===a&&(c++,i=!0),i?a--:a++,o.beginPath();var r=.5522848,l=10*r,u=13*r;o.moveTo(135,225),o.bezierCurveTo(135,89-u+t,102-l+43,212,145,212),o.bezierCurveTo(102+l+43,212,155,89-u+t,155,225),o.bezierCurveTo(155,89+u+t,102+l+43,238,145,238),o.bezierCurveTo(102-l+43,238,135,89+u+t,135,225),o.fillStyle="#fff",o.fill(),n(o,145,225,8,10,"#8D4F1F"),n(o,143,223,3,4,"#fff"),o.beginPath(),o.strokeStyle="#8D4F1F";for(var s=0;s<25;s++)o.moveTo(132.5+s,e-a),o.lineTo(132.5+s,e-Math.floor(23*Math.sin(Math.PI*s/25))),o.moveTo(132.5+s,e+a),o.lineTo(132.5+s,e+Math.floor(23*Math.sin(Math.PI*s/25))),o.stroke();o.closePath()}l(),r.addEventListener("dblclick",(function(){var e=setInterval((function(){3===c?(console.log(c),clearInterval(e),c=0):l()}),25)})),o.restore()}(),o.save(),o.moveTo(117,250),o.beginPath(),o.bezierCurveTo(117,250,123,260,131,250),o.closePath(),i(o,"#8D4F1F"),o.restore()},o.prototype.drawChatBox=function(e,o,t,r,n){e.beginPath(),e.moveTo(o,t+.35*n),e.quadraticCurveTo(o+.04*r,t+.02*n,o+.5*r,t),e.quadraticCurveTo(o+.96*r,t+.02*n,o+r,t+.35*n),e.quadraticCurveTo(o+r,t+.7*n,o+.58*r,t+.72*n),e.quadraticCurveTo(o+.5*r,t+.9*n,o+.6*r,t+n),e.quadraticCurveTo(o+.38*r,t+.8*n,o+.38*r,t+.72*n),e.quadraticCurveTo(o,t+.7*n,o,t+.35*n),e.stroke()},o}();var t=function(){function e(){this.init(),this.mediaRecorder=null}return e.prototype.init=function(){var e=document.createElement("div");e.id="yybear_pop",e.appendChild(this.createFrag('<canvas id=\'yylive_bear\' width="200" height="300"></canvas>')),document.body.appendChild(e),this.render()},e.prototype.createFrag=function(e){return document.createRange().createContextualFragment(e)},e.prototype.render=function(){var e=new o;e.init(),e.dbclick((function(){}))},e.prototype.getAudioRecorder=function(){return e=this,o=void 0,r=function(){var e,o=this;return function(e,o){var t,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((n=(n=a.trys).length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=o.call(e,a)}catch(e){i=[6,e],r=0}finally{t=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}(this,(function(t){switch(t.label){case 0:return this.mediaRecorder?[3,2]:navigator.mediaDevices.getUserMedia?[4,navigator.mediaDevices.getUserMedia({audio:!0})]:(alert("很抱歉，当前浏览器不支持该功能~"),[2]);case 1:if(e=t.sent(),console.log("stream:",e),!e)return console.error("授权失败"),[2];console.log("授权成功"),this.mediaRecorder=new MediaRecorder(e),t.label=2;case 2:return console.log(this.mediaRecorder),this.mediaRecorder.start(),this.mediaRecorder.ondataavailable=function(e){console.log("===="),console.log(e)},setTimeout((function(){var e;console.log("时间到"),null===(e=o.mediaRecorder)||void 0===e||e.stop()}),5e3),[2]}}))},new((t=void 0)||(t=Promise))((function(n,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function c(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var o;e.done?n(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(a,c)}l((r=r.apply(e,o||[])).next())}));var e,o,t,r},e}();window.onload=function(){new t}})();